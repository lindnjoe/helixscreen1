<!--
  Copyright (C) 2025 356C LLC
  Author: Preston Brown <pbrown@brown-house.net>

  This file is part of HelixScreen.

  HelixScreen is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  HelixScreen is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with HelixScreen. If not, see <https://www.gnu.org/licenses/>.
-->

<component>
	<!-- WiFi Password Entry Modal -->
	<!-- Overlay modal for entering WiFi password and connecting -->

	<consts>
		<!-- Responsive constants (overridden by C++ at runtime based on screen size) -->
		<!-- Defaults for SMALL screens (480x320) -->
		<px name="modal_password_width" value="360"/>
		<px name="modal_password_height" value="220"/>
		<px name="modal_input_height" value="50"/>
		<px name="modal_button_height" value="44"/>
		<px name="modal_button_width_cancel" value="90"/>
		<px name="modal_button_width_connect" value="110"/>
		<px name="modal_padding" value="16"/>
		<px name="modal_gap" value="10"/>
	</consts>

	<view extends="lv_obj"
	      width="100%"
	      height="100%"
	      name="wifi_password_modal_root"
	      style_bg_opa="180"
	      style_border_width="0"
	      style_radius="0"
	      style_pad_all="0">

		<!-- Reactive visibility binding: hidden when wifi_password_modal_visible == 0 -->
		<lv_obj-bind_flag_if_eq subject="wifi_password_modal_visible" flag="hidden" ref_value="0"/>

		<!-- Centered modal card -->
		<lv_obj width="#modal_password_width"
		        height="#modal_password_height"
		        align="center"
		        style_border_width="2"
		        style_pad_all="#modal_padding"
		        style_pad_gap="#modal_gap"
		        flex_flow="column"
		        style_flex_main_place="space_between"
		        style_flex_cross_place="start">

			<!-- Title -->
			<lv_label name="modal_title"
			          text="Enter WiFi Password"
			          width="100%"
			          style_text_font="#font_heading"
			         			          style_text_align="center"/>

			<!-- Network SSID -->
			<text_small name="modal_ssid"
			            text="Network"
			            width="100%"
			            style_text_align="center"
			            style_margin_bottom="8"/>

			<!-- Password input -->
			<lv_textarea name="password_input"
			             width="100%"
			             height="#modal_input_height"
			             placeholder="Password"
			             password_mode="true"
			             max_length="64"
			             one_line="true"
			             style_border_width="1"
			             style_pad_all="12"
			             style_text_font="montserrat_16"
			            />

			<!-- Status message (hidden by default, shown on error) -->
			<text_small name="modal_status"
			            text=""
			            width="100%"
			            hidden="true"
			            style_text_align="center"
			            style_margin_top="4"/>

			<!-- Button row (bottom-aligned, centered text) -->
			<lv_obj width="100%"
			        height="#modal_button_height"
			        style_bg_opa="0"
			        style_border_width="0"
			        style_pad_all="0"
			        style_pad_gap="#modal_gap"
			        flex_flow="row"
			        style_flex_main_place="end"
			        style_flex_cross_place="end">

				<!-- Cancel button -->
				<lv_button name="modal_cancel_btn"
				           width="#modal_button_width_cancel"
				           height="#modal_button_height"
				           style_border_width="1"
				           flex_flow="row"
				           style_flex_main_place="center"
				           style_flex_cross_place="center">
					<event_cb trigger="clicked" callback="on_modal_cancel_clicked"/>
					<text_body text="Cancel"/>
				</lv_button>

				<!-- Connect button -->
				<lv_button name="modal_connect_btn"
				           width="#modal_button_width_connect"
				           height="#modal_button_height"
				           style_border_width="0"
				           flex_flow="row"
				           style_flex_main_place="center"
				           style_flex_cross_place="center">
					<!-- Disable button while connecting (wifi_connecting == 1) -->
					<lv_obj-bind_state_if_eq subject="wifi_connecting" state="disabled" ref_value="1"/>
					<event_cb trigger="clicked" callback="on_modal_connect_clicked"/>
					<text_body text="Connect"/>
				</lv_button>
			</lv_obj>
		</lv_obj>
	</view>
</component>
